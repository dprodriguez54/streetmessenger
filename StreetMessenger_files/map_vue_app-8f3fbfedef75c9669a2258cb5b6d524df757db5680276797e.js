function initMapsIndexVue(){vm=new Vue({el:"#app",data:{shelters:shelters,booleanFilters:filters,cities:cities,genderFilter:"all",ageFilter:"all",hasChildren:!1,singleGender:!1,shelterCounterCache:shelters.length,cityFilter:"all",previousCityFilter:"all",noMatchingSheltersMessage:"We couldn't find any shelters matching your requirements.\nTry a different search, or look at our resources list at the bottom of the page."},mounted:function(){mapObject=new google.maps.Map(document.getElementById("mapsIndex__map"),{center:{lat:49.2753553,lng:-123.133056},zoom:12}),this.shelters.forEach(function(e){e.marker_on&&(e.infowindow=new google.maps.InfoWindow({content:e.infowindow,maxWidth:225}),e.marker=new google.maps.Marker({position:{lat:e.latitude,lng:e.longitude},map:mapObject,title:e.name}),e.marker.addListener("click",function(){e.infowindow.anchor?e.infowindow.close(mapObject,e.marker):(vm.hideAllWindows(),e.infowindow.open(mapObject,e.marker))}))})},methods:{findLocation:function(){navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){mapObject.setCenter({lat:e.coords.latitude,lng:e.coords.longitude})},function(){alert("Error: Not able to find your location.")}):alert("Error: Your browser doesn't support geolocation.")},updateMarker:function(e,t){if(e.show=t,e.marker_on&&(t?e.marker.setMap(mapObject):e.marker.setMap(null),vm.cityFilterHasChanged()&&t)){var n=new google.maps.LatLng(e.marker.position.lat(),e.marker.position.lng());mapBounds.extend(n)}},applyFilters:function(){return vm.cityFilterHasChanged()&&(mapBounds=new google.maps.LatLngBounds),this.shelterCounterCache=0,this.shelters.forEach(function(e){var t=vm.filters__city(e,vm.cityFilter);return t&&(t=vm.filters__gender(e,vm.genderFilter,vm.hasChildren,vm.singleGender))&&(t=vm.filters__age(e,vm.ageFilter))&&(t=vm.filters__categories(e,vm.booleanFilters.categories))&&(t=vm.filters__others(e,vm.booleanFilters))?(vm.shelterCounterCache++,void vm.updateMarker(e,t)):void vm.updateMarker(e,t)}),0===vm.shelterCounterCache?void alert(vm.noMatchingSheltersMessage):void(vm.cityFilterHasChanged()&&(vm.updateMapByBounds(),vm.previousCityFilter=vm.cityFilter))},showAllShelters:function(){this.booleanFilters.categories.forEach(function(e){e.value=!0}),this.booleanFilters.medical.forEach(function(e){e.value=!1}),this.booleanFilters.general.forEach(function(e){e.value=!1}),this.singleGender=!1,this.hasChildren=!1,this.genderFilter="all",this.ageFilter="all",this.cityFilter="all",this.previousCityFilter="all",this.shelterCounterCache=this.shelters.length,$("#mapsIndex__genderSelect").selectpicker("val","all"),$("#mapsIndex__ageSelect").selectpicker("val","all"),$("#mapsIndex__citySelect").selectpicker("val","all"),this.shelters.forEach(function(e){vm.updateMarker(e,!0)})},filters__city:function(e,t){return t&&"all"!=t?e.city==t:!0},filters__age:function(e,t){return"all"===t?!0:e.age_min<=t&&e.age_max>=t},filters__gender:function(e,t,n,r){var i=null;if(n)switch(t){case"all":if(!r){i=e.takes_men_with_children||e.takes_women_with_children;break}i=(e.takes_men_with_children||e.takes_women_with_children)&&!(e.takes_women_with_children&&e.takes_men_with_children);case"male":i=e.takes_men_with_children;break;case"female":i=e.takes_women_with_children}else switch(t){case"all":if(!r){i=e.takes_women||e.takes_men;break}i=(e.takes_men||e.takes_women)&&!(e.takes_women&&e.takes_men);case"male":i=e.takes_men;break;case"female":i=e.takes_women}return i},filters__categories:function(e,t){var n=!1;return t.some(function(t){return t.value&&e[t.attribute]?(n=!0,!0):!1}),n},filters__others:function(e,t){var n=!0;return Object.entries(t).some(function(t){return"categories"==t[0]?!1:(t[1].some(function(t){return t.value?(n=e[t.attribute]||e[t.referral],!1):!1}),!n)}),n},updateMapByBounds:function(){mapObject.fitBounds(mapBounds),mapObject.panToBounds(mapBounds),mapBounds=null,mapObject.getZoom()>15&&mapObject.setZoom(15)},iconClass:function(e){return" shelterIcon shelterIcon_"+e},hideAllWindows:function(){this.shelters.forEach(function(e){e.marker_on&&e.infowindow.close()})},cityFilterHasChanged:function(){return this.cityFilter!=this.previousCityFilter&&"all"!=this.cityFilter}},computed:{noVisibleShelters:function(){return 0===this.shelterCounterCache},visibleShelters:function(){return this.shelters.filter(function(e){return e.show})}}})}